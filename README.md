# Fast Noise Generator API

Микросервис на FastAPI для потоковой генерации PNG-изображений со случайным шумом.

## Особенности реализации
- **Потоковая передача (Streaming):** PNG формируется построчно с использованием `zlib.compressobj`. Это позволяет генерировать изображения любого размера (например 50000x50000) при стабильно низком потреблении RAM.
- **Мониторинг ресурсов:** Эндпоинт `/health` отслеживает реальное использование памяти процессом (RSS) через `psutil`.
- **Memory Safety:** Реализован механизм защиты от переполнения памяти. При достижении лимита `MAX_MEMORY_MB` сервис возвращает ошибку 503 (для примера я ставил 30 мб и уже при проверке сервер падал).
- **Asynchronous:** Сервис не блокируется во время генерации благодаря асинхронности и `await asyncio.sleep(0)` в цикле обработки.

## Требования
- Python 3.8+
- Зависимости из `requirements.txt` (fastapi, uvicorn, psutil)

## Запуск

```bash
pip install -r requirements.txt
python main.py
```
Сервис будет запущен на http://127.0.0.1:8001

API Методы
1. Состояние сервиса
GET /health Возвращает JSON с текущим потреблением памяти и статистикой запросов.

2. Генерация изображения
GET /generate?w={int}&h={int} Генерирует случайный шум в формате PNG.

w: ширина (пиксели)

h: высота (пиксели)

Тестирование производительности
Для проверки скорости генерации и стабильности памяти без записи на диск:

Bash
```bash
curl -o /dev/null "[http://127.0.0.1:8001/generate?w=20000&h=20000](http://127.0
```
